<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Related Products & Wishlist Test</title>
    
    <!-- Tailwind CSS (same version as theme) -->
    <script src="https://cdn.tailwindcss.com/2.2.19"></script>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Swiper CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@10/swiper-bundle.min.css">
    
    <!-- Theme CSS -->
    <link rel="stylesheet" href="css/pages.single-product.css">
    <link rel="stylesheet" href="css/components/wishlist.css">
    
    <style>
        /* Test specific styles */
        :root {
            --primary-pink: #EE81B3;
        }
        
        .related-products-test {
            padding: 40px 0;
            background: #f9fafb;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }
    </style>
</head>
<body class="bg-gray-50">
    
    <div class="container mx-auto py-8">
        <h1 class="text-3xl font-bold mb-8 text-center">Related Products & Wishlist Test</h1>
        
        <!-- Test: Related Products Section -->
        <section class="related products">
            <h2 class="text-2xl font-bold text-gray-900 mb-8 text-center">You may also likeâ€¦</h2>
            
            <div class="products grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6">
                
                <!-- Product 1 -->
                <div class="product-card group relative bg-white rounded-lg shadow-sm overflow-hidden hover:shadow-md transition-shadow">
                    <div class="product-image relative overflow-hidden aspect-square">
                        <div class="product-slider swiper relative">
                            <div class="swiper-wrapper">
                                <div class="swiper-slide">
                                    <a href="#" class="block aspect-square">
                                        <img src="https://via.placeholder.com/400x400/f3f4f6/6b7280?text=Product+1" 
                                             alt="Test Product 1" 
                                             class="w-full h-full object-cover transition-transform duration-300 group-hover:scale-105">
                                    </a>
                                </div>
                                <div class="swiper-slide">
                                    <a href="#" class="block aspect-square">
                                        <img src="https://via.placeholder.com/400x400/ddd6fe/8b5cf6?text=Alt+View+1" 
                                             alt="Test Product 1 Alt" 
                                             class="w-full h-full object-cover transition-transform duration-300 group-hover:scale-105">
                                    </a>
                                </div>
                            </div>
                            <div class="swiper-button-prev product-slider-prev">
                                <i class="fas fa-chevron-left"></i>
                            </div>
                            <div class="swiper-button-next product-slider-next">
                                <i class="fas fa-chevron-right"></i>
                            </div>
                            <div class="swiper-pagination product-slider-pagination"></div>
                        </div>
                        
                        <!-- Wishlist Button -->
                        <div class="absolute top-4 right-4 z-10">
                            <button class="add-to-wishlist w-8 h-8 bg-white rounded-full flex items-center justify-center shadow-sm hover:shadow-md transition-all duration-200 hover:scale-110" 
                                    data-product-id="1" 
                                    title="Add to Wishlist">
                                <i class="far fa-heart text-gray-400 text-sm"></i>
                            </button>
                        </div>
                    </div>
                    
                    <div class="product-info p-4">
                        <h3 class="product-title font-medium text-gray-900 mb-2">
                            <a href="#" class="hover:text-gray-600 transition-colors">Test Product 1</a>
                        </h3>
                        <div class="product-price">
                            <p class="price text-lg font-semibold text-gray-900">$29.99</p>
                        </div>
                    </div>
                </div>
                
                <!-- Product 2 -->
                <div class="product-card group relative bg-white rounded-lg shadow-sm overflow-hidden hover:shadow-md transition-shadow">
                    <div class="product-image relative overflow-hidden aspect-square">
                        <div class="product-slider swiper relative">
                            <div class="swiper-wrapper">
                                <div class="swiper-slide">
                                    <a href="#" class="block aspect-square">
                                        <img src="https://via.placeholder.com/400x400/fef3c7/f59e0b?text=Product+2" 
                                             alt="Test Product 2" 
                                             class="w-full h-full object-cover transition-transform duration-300 group-hover:scale-105">
                                    </a>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Wishlist Button -->
                        <div class="absolute top-4 right-4 z-10">
                            <button class="add-to-wishlist w-8 h-8 bg-white rounded-full flex items-center justify-center shadow-sm hover:shadow-md transition-all duration-200 hover:scale-110" 
                                    data-product-id="2" 
                                    title="Add to Wishlist">
                                <i class="far fa-heart text-gray-400 text-sm"></i>
                            </button>
                        </div>
                    </div>
                    
                    <div class="product-info p-4">
                        <h3 class="product-title font-medium text-gray-900 mb-2">
                            <a href="#" class="hover:text-gray-600 transition-colors">Test Product 2</a>
                        </h3>
                        <div class="product-price">
                            <p class="price text-lg font-semibold text-gray-900">$39.99</p>
                        </div>
                    </div>
                </div>
                
                <!-- Product 3 -->
                <div class="product-card group relative bg-white rounded-lg shadow-sm overflow-hidden hover:shadow-md transition-shadow">
                    <div class="product-image relative overflow-hidden aspect-square">
                        <div class="product-slider swiper relative">
                            <div class="swiper-wrapper">
                                <div class="swiper-slide">
                                    <a href="#" class="block aspect-square">
                                        <img src="https://via.placeholder.com/400x400/dcfce7/22c55e?text=Product+3" 
                                             alt="Test Product 3" 
                                             class="w-full h-full object-cover transition-transform duration-300 group-hover:scale-105">
                                    </a>
                                </div>
                                <div class="swiper-slide">
                                    <a href="#" class="block aspect-square">
                                        <img src="https://via.placeholder.com/400x400/fecaca/ef4444?text=Alt+View+3" 
                                             alt="Test Product 3 Alt" 
                                             class="w-full h-full object-cover transition-transform duration-300 group-hover:scale-105">
                                    </a>
                                </div>
                                <div class="swiper-slide">
                                    <a href="#" class="block aspect-square">
                                        <img src="https://via.placeholder.com/400x400/e0e7ff/6366f1?text=Third+View+3" 
                                             alt="Test Product 3 Third" 
                                             class="w-full h-full object-cover transition-transform duration-300 group-hover:scale-105">
                                    </a>
                                </div>
                            </div>
                            <div class="swiper-button-prev product-slider-prev">
                                <i class="fas fa-chevron-left"></i>
                            </div>
                            <div class="swiper-button-next product-slider-next">
                                <i class="fas fa-chevron-right"></i>
                            </div>
                            <div class="swiper-pagination product-slider-pagination"></div>
                        </div>
                        
                        <!-- Wishlist Button -->
                        <div class="absolute top-4 right-4 z-10">
                            <button class="add-to-wishlist in-wishlist w-8 h-8 bg-white rounded-full flex items-center justify-center shadow-sm hover:shadow-md transition-all duration-200 hover:scale-110" 
                                    data-product-id="3" 
                                    title="Remove from Wishlist">
                                <i class="fas fa-heart text-red-500 text-sm"></i>
                            </button>
                        </div>
                    </div>
                    
                    <div class="product-info p-4">
                        <h3 class="product-title font-medium text-gray-900 mb-2">
                            <a href="#" class="hover:text-gray-600 transition-colors">Test Product 3 (In Wishlist)</a>
                        </h3>
                        <div class="product-price">
                            <p class="price text-lg font-semibold text-gray-900">$49.99</p>
                        </div>
                    </div>
                </div>
                
                <!-- Product 4 -->
                <div class="product-card group relative bg-white rounded-lg shadow-sm overflow-hidden hover:shadow-md transition-shadow">
                    <div class="product-image relative overflow-hidden aspect-square">
                        <div class="product-slider swiper relative">
                            <div class="swiper-wrapper">
                                <div class="swiper-slide">
                                    <a href="#" class="block aspect-square">
                                        <img src="https://via.placeholder.com/400x400/fdf4ff/a855f7?text=Product+4" 
                                             alt="Test Product 4" 
                                             class="w-full h-full object-cover transition-transform duration-300 group-hover:scale-105">
                                    </a>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Wishlist Button -->
                        <div class="absolute top-4 right-4 z-10">
                            <button class="add-to-wishlist w-8 h-8 bg-white rounded-full flex items-center justify-center shadow-sm hover:shadow-md transition-all duration-200 hover:scale-110" 
                                    data-product-id="4" 
                                    title="Add to Wishlist">
                                <i class="far fa-heart text-gray-400 text-sm"></i>
                            </button>
                        </div>
                    </div>
                    
                    <div class="product-info p-4">
                        <h3 class="product-title font-medium text-gray-900 mb-2">
                            <a href="#" class="hover:text-gray-600 transition-colors">Test Product 4</a>
                        </h3>
                        <div class="product-price">
                            <p class="price text-lg font-semibold text-gray-900">$19.99</p>
                        </div>
                    </div>
                </div>
                
            </div>
        </section>
        
        <!-- Test Controls -->
        <div class="mt-12 p-6 bg-white rounded-lg shadow-sm">
            <h3 class="text-lg font-semibold mb-4">Test Controls</h3>
            <div class="flex flex-wrap gap-4">
                <button id="init-sliders" class="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600">Initialize Sliders</button>
                <button id="test-wishlist" class="px-4 py-2 bg-pink-500 text-white rounded hover:bg-pink-600">Test Wishlist</button>
                <button id="check-visibility" class="px-4 py-2 bg-green-500 text-white rounded hover:bg-green-600">Check Elements</button>
            </div>
            <div id="debug-output" class="mt-4 p-3 bg-gray-100 rounded text-sm font-mono hidden"></div>
        </div>
    </div>
    
    <!-- Scripts -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/swiper@10/swiper-bundle.min.js"></script>
    
    <script>
        // Product Card Sliders Initialization Function
        function initializeProductCardSliders() {
            if (typeof Swiper === 'undefined') {
                console.error('Swiper is not loaded');
                return;
            }

            document.querySelectorAll('.product-slider').forEach(function(el) {
                // Avoid double init
                if (el.__eshop_inited) return;
                el.__eshop_inited = true;
                
                try {
                    var swiperConfig = {
                        pagination: {
                            el: el.querySelector('.swiper-pagination'),
                            clickable: true
                        },
                        navigation: {
                            nextEl: el.querySelector('.swiper-button-next'),
                            prevEl: el.querySelector('.swiper-button-prev'),
                        },
                        loop: true,
                        autoplay: false,
                        effect: 'fade',
                        fadeEffect: {
                            crossFade: true
                        },
                        speed: 300,
                        on: {
                            init: function() {
                                var slideCount = this.slides.length;
                                if (slideCount <= 1) {
                                    var nav = el.querySelectorAll('.swiper-button-prev, .swiper-button-next, .swiper-pagination');
                                    nav.forEach(function(navEl) {
                                        navEl.style.display = 'none';
                                    });
                                }
                            }
                        }
                    };

                    new Swiper(el, swiperConfig);
                    console.log('Initialized slider for:', el);
                } catch (e) {
                    console.warn('Swiper init failed for product slider', e);
                }
            });
        }
        
        // Wishlist functionality
        function initWishlist() {
            $(document).on('click', '.add-to-wishlist', function(e) {
                e.preventDefault();
                var $button = $(this);
                var productId = $button.data('product-id');
                
                // Simulate wishlist toggle
                $button.addClass('loading');
                
                setTimeout(function() {
                    if ($button.hasClass('in-wishlist')) {
                        $button.removeClass('in-wishlist').find('i').removeClass('fas text-red-500').addClass('far text-gray-400');
                        console.log('Removed from wishlist:', productId);
                    } else {
                        $button.addClass('in-wishlist').find('i').removeClass('far text-gray-400').addClass('fas text-red-500');
                        console.log('Added to wishlist:', productId);
                    }
                    $button.removeClass('loading');
                }, 500);
            });
        }
        
        // Initialize on load
        $(document).ready(function() {
            console.log('Document ready - initializing components');
            initializeProductCardSliders();
            initWishlist();
            
            // Test buttons
            $('#init-sliders').click(function() {
                initializeProductCardSliders();
                showDebug('Sliders re-initialized');
            });
            
            $('#test-wishlist').click(function() {
                $('.add-to-wishlist').first().click();
                showDebug('Triggered first wishlist button');
            });
            
            $('#check-visibility').click(function() {
                var sliders = $('.product-slider').length;
                var wishlistBtns = $('.add-to-wishlist').length;
                var swiperInstances = $('.product-slider').map(function() {
                    return this.swiper ? 'initialized' : 'not initialized';
                }).get();
                
                showDebug('Sliders found: ' + sliders + '\\nWishlist buttons: ' + wishlistBtns + '\\nSwiper states: ' + swiperInstances.join(', '));
            });
        });
        
        function showDebug(message) {
            $('#debug-output').removeClass('hidden').text(message);
            setTimeout(function() {
                $('#debug-output').addClass('hidden');
            }, 3000);
        }
    </script>
</body>
</html>